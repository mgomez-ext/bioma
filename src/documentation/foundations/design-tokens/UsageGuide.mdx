import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Bioma 2.0/Foundations/Design Tokens/Usage Guide" />

# Using Design Tokens

Best practices and patterns for effectively using design tokens in code and design tools.

## Core Principles

### 1. Always Use Tokens

Avoid hardcoded values. Tokens ensure consistency and enable theming.

```scss
// ❌ Don't hardcode values
.button {
  background: #E30038;
  padding: 12px 24px;
  border-radius: 8px;
  color: #FFFFFF;
}

// ✅ Use tokens
.button {
  background: var(--primary-default);
  padding: var(--spacing-3) var(--spacing-6);
  border-radius: var(--radius-md);
  color: var(--primary-strong);
}
```

---

### 2. Use Semantic Tokens in Components

Reference semantic tokens, not foundation tokens, for automatic theme adaptation.

```scss
// ❌ Don't use foundation tokens
.card {
  background: var(--neutral-white);
  color: var(--neutral-950);
  border: 1px solid var(--neutral-300);
}

// ✅ Use semantic tokens
.card {
  background: var(--bg-default);
  color: var(--text-primary);
  border: 1px solid var(--border-default);
}
```

**Why**: Semantic tokens automatically adapt to light/dark mode. Foundation tokens stay the same.

---

### 3. Match Token Purpose to Element

Choose tokens that semantically match your UI element.

```scss
// ❌ Wrong purpose
.heading {
  color: var(--text-secondary);  // Too subtle for heading
}

// ✅ Right purpose
.heading {
  color: var(--text-strong);     // Appropriate emphasis
}
```

---

## Using Tokens in CSS/SCSS

### Basic Syntax

Use CSS custom properties with `var()`:

```scss
.component {
  property: var(--token-name);
}
```

### With Fallbacks

Provide fallback values for robustness:

```scss
.component {
  color: var(--text-primary, #121212);
  padding: var(--spacing-4, 16px);
}
```

**When to use fallbacks**:
- Public-facing libraries
- Progressive enhancement scenarios
- Browser compatibility concerns

**When to skip fallbacks**:
- Internal applications where tokens are guaranteed
- Modern build pipelines with token validation

---

### Combining Tokens

Build complex values from multiple tokens:

```scss
.card {
  /* Combine border tokens */
  border: 1px solid var(--border-default);

  /* Combine spacing tokens */
  padding: var(--spacing-4) var(--spacing-6);
  margin: var(--spacing-6) 0;

  /* Combine shadow and transition */
  box-shadow: var(--shadow-md);
  transition: box-shadow var(--transition-base);

  &:hover {
    box-shadow: var(--shadow-lg);
  }
}
```

---

### Token Math

You can perform calculations with tokens:

```scss
.component {
  /* Valid - multiply spacing */
  margin-top: calc(var(--spacing-4) * 2);     /* 32px */

  /* Valid - combine different tokens */
  padding: calc(var(--spacing-3) + 2px);      /* 14px */

  /* Valid - negative margins */
  margin-left: calc(var(--spacing-6) * -1);   /* -24px */
}
```

**Best practice**: Prefer existing tokens over calculations when possible.

---

## Color Token Usage

### Text Colors

Use text tokens for all text content:

```scss
.heading {
  color: var(--text-strong);        // Headings
}

.body {
  color: var(--text-primary);       // Body text
}

.label {
  color: var(--text-secondary);     // Labels
}

.caption {
  color: var(--text-tertiary);      // Captions
}

.placeholder {
  color: var(--text-muted);         // Placeholders
}

.disabled {
  color: var(--text-disabled);      // Disabled state
}

.link {
  color: var(--text-link);          // Links

  &:hover {
    color: var(--text-link-hover);
  }
}
```

---

### Background Colors

Use background tokens for surfaces:

```scss
.page {
  background: var(--bg-default);    // Main surface
}

.card {
  background: var(--bg-subtle);     // Elevated surface
}

.sidebar {
  background: var(--bg-muted);      // Contrasting surface
}

.modal-backdrop {
  background: var(--bg-overlay);    // Semi-transparent
}

.dark-section {
  background: var(--bg-inverse);    // Inverted surface
  color: var(--text-inverse);
}
```

---

### Border Colors

Use border tokens for all borders and dividers:

```scss
.divider {
  border-bottom: 1px solid var(--border-subtle);  // Very light
}

.input {
  border: 1px solid var(--border-default);        // Standard

  &:focus {
    border-color: var(--border-focus);            // Focus state
  }
}

.card {
  border: 2px solid var(--border-strong);         // Emphasized
}
```

---

### Interactive States

Apply state-specific tokens for interactions:

```scss
.button-primary {
  background: var(--primary-default);
  color: var(--primary-strong);

  &:hover {
    background: var(--primary-hover);
  }

  &:active {
    background: var(--primary-active);
  }

  &:disabled {
    background: var(--primary-disabled);
    color: var(--text-disabled);
    cursor: not-allowed;
  }
}

.button-secondary {
  background: var(--secondary-default);
  color: var(--text-primary);
  border: 1px solid var(--secondary-border);

  &:hover {
    background: var(--secondary-hover);
    border-color: var(--secondary-border-hover);
  }

  &:active {
    background: var(--secondary-active);
  }
}
```

---

### Status Colors

Use status tokens for feedback messages:

```scss
.alert-success {
  background: var(--success-subtle);
  color: var(--success-strong);
  border-left: 4px solid var(--success-default);
}

.alert-warning {
  background: var(--warning-subtle);
  color: var(--warning-strong);
  border-left: 4px solid var(--warning-default);
}

.alert-error {
  background: var(--error-subtle);
  color: var(--error-strong);
  border-left: 4px solid var(--error-default);
}

.alert-info {
  background: var(--info-subtle);
  color: var(--info-strong);
  border-left: 4px solid var(--info-default);
}
```

---

## Spacing Token Usage

### Padding

Use spacing tokens for internal spacing:

```scss
.button {
  padding: var(--spacing-3) var(--spacing-6);      // 12px 24px
}

.card {
  padding: var(--spacing-6);                        // 24px
}

.input {
  padding: var(--spacing-3) var(--spacing-4);      // 12px 16px
}

.section {
  padding: var(--spacing-12) var(--spacing-8);     // 48px 32px
}
```

---

### Margin

Use spacing tokens for external spacing:

```scss
.section {
  margin-bottom: var(--spacing-12);                 // 48px
}

.card {
  margin-bottom: var(--spacing-6);                  // 24px
}

.paragraph {
  margin-bottom: var(--spacing-4);                  // 16px
}

.label {
  margin-bottom: var(--spacing-2);                  // 8px
}
```

---

### Gaps (Flexbox/Grid)

Use spacing tokens for layout gaps:

```scss
.flex-container {
  display: flex;
  gap: var(--spacing-4);                            // 16px between items
}

.grid {
  display: grid;
  gap: var(--spacing-6);                            // 24px between cells
  grid-template-columns: repeat(3, 1fr);
}

.button-group {
  display: flex;
  gap: var(--spacing-2);                            // 8px between buttons
}
```

---

## Typography Token Usage

### Font Families

```scss
.body {
  font-family: var(--font-primary);  // Sora for UI
}

.code {
  font-family: var(--font-mono);     // SF Mono for code
}
```

---

### Font Sizes

```scss
.caption {
  font-size: var(--font-xs);         // 12px
}

.body-small {
  font-size: var(--font-sm);         // 14px
}

.body {
  font-size: var(--font-base);       // 16px (default)
}

.h4 {
  font-size: var(--font-xl);         // 20px
}

.h3 {
  font-size: var(--font-2xl);        // 24px
}

.h2 {
  font-size: var(--font-3xl);        // 30px
}

.h1 {
  font-size: var(--font-4xl);        // 36px
}

.hero {
  font-size: var(--font-5xl);        // 48px
}
```

---

### Font Weights

```scss
.light-text {
  font-weight: var(--font-light);     // 300
}

.body {
  font-weight: var(--font-regular);   // 400 (default)
}

.emphasized {
  font-weight: var(--font-medium);    // 500
}

.heading {
  font-weight: var(--font-semibold);  // 600
}

.strong {
  font-weight: var(--font-bold);      // 700
}
```

---

### Line Heights

```scss
.display-text {
  line-height: var(--leading-tight);   // 1.25
}

.heading {
  line-height: var(--leading-snug);    // 1.375
}

.body {
  line-height: var(--leading-normal);  // 1.5 (default)
}

.comfortable-reading {
  line-height: var(--leading-relaxed); // 1.625
}
```

---

### Complete Typography Example

```scss
.heading-1 {
  font-family: var(--font-primary);
  font-size: var(--font-4xl);
  font-weight: var(--font-bold);
  line-height: var(--leading-tight);
  letter-spacing: var(--tracking-tight);
  color: var(--text-strong);
  margin-bottom: var(--spacing-6);
}

.body-text {
  font-family: var(--font-primary);
  font-size: var(--font-base);
  font-weight: var(--font-regular);
  line-height: var(--leading-normal);
  color: var(--text-primary);
  margin-bottom: var(--spacing-4);
}

.code-block {
  font-family: var(--font-mono);
  font-size: var(--font-sm);
  line-height: var(--leading-relaxed);
  background: var(--bg-muted);
  padding: var(--spacing-4);
  border-radius: var(--radius-md);
  color: var(--text-secondary);
}
```

---

## Effect Token Usage

### Shadows

```scss
.card-flat {
  box-shadow: var(--shadow-xs);      // Subtle lift
}

.card {
  box-shadow: var(--shadow-md);      // Standard elevation
}

.dropdown {
  box-shadow: var(--shadow-lg);      // Floating element
}

.modal {
  box-shadow: var(--shadow-xl);      // Maximum elevation
}

/* Interactive shadows */
.card-interactive {
  box-shadow: var(--shadow-sm);
  transition: box-shadow var(--transition-base);

  &:hover {
    box-shadow: var(--shadow-lg);
  }
}
```

---

### Transitions

```scss
.button {
  transition: all var(--transition-fast);     // Quick feedback
}

.card {
  transition: transform var(--transition-base);  // Standard
}

.modal {
  transition: opacity var(--transition-slow);    // Dramatic entrance
}

/* Custom easing */
.slide-in {
  transition: transform 300ms var(--ease-out);
}

/* Multiple properties */
.interactive {
  transition:
    background var(--transition-fast),
    box-shadow var(--transition-base),
    transform var(--transition-base);
}
```

---

### Z-Index

```scss
.sticky-header {
  z-index: var(--z-sticky);          // 1020
}

.dropdown-menu {
  z-index: var(--z-dropdown);        // 1000
}

.modal-backdrop {
  z-index: var(--z-modal-backdrop);  // 1040
}

.modal {
  z-index: var(--z-modal);           // 1050
}

.tooltip {
  z-index: var(--z-tooltip);         // 1070 (highest)
}
```

---

## Component Patterns

### Card Component

```scss
.card {
  background: var(--bg-default);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  padding: var(--spacing-6);
  box-shadow: var(--shadow-sm);
  transition: all var(--transition-base);

  &:hover {
    box-shadow: var(--shadow-md);
  }

  &__title {
    font-size: var(--font-2xl);
    font-weight: var(--font-semibold);
    color: var(--text-strong);
    margin-bottom: var(--spacing-3);
  }

  &__content {
    font-size: var(--font-base);
    line-height: var(--leading-relaxed);
    color: var(--text-secondary);
  }
}
```

---

### Button Component

```scss
.button {
  font-family: var(--font-primary);
  font-size: var(--font-base);
  font-weight: var(--font-medium);
  padding: var(--spacing-3) var(--spacing-6);
  border-radius: var(--radius-md);
  border: none;
  cursor: pointer;
  transition: all var(--transition-fast);

  /* Primary variant */
  &--primary {
    background: var(--primary-default);
    color: var(--primary-strong);

    &:hover {
      background: var(--primary-hover);
    }

    &:active {
      background: var(--primary-active);
    }

    &:disabled {
      background: var(--primary-disabled);
      color: var(--text-disabled);
      cursor: not-allowed;
    }
  }

  /* Secondary variant */
  &--secondary {
    background: var(--secondary-default);
    color: var(--text-primary);
    border: 1px solid var(--secondary-border);

    &:hover {
      background: var(--secondary-hover);
      border-color: var(--secondary-border-hover);
    }

    &:active {
      background: var(--secondary-active);
    }
  }
}
```

---

### Input Component

```scss
.input {
  font-family: var(--font-primary);
  font-size: var(--font-base);
  padding: var(--spacing-3) var(--spacing-4);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  background: var(--bg-default);
  color: var(--text-primary);
  transition: border-color var(--transition-fast);

  &::placeholder {
    color: var(--text-muted);
  }

  &:hover {
    border-color: var(--border-strong);
  }

  &:focus {
    outline: none;
    border-color: var(--border-focus);
    box-shadow: 0 0 0 3px var(--primary-subtle);
  }

  &:disabled {
    background: var(--bg-muted);
    color: var(--text-disabled);
    cursor: not-allowed;
  }

  &--error {
    border-color: var(--error-default);

    &:focus {
      box-shadow: 0 0 0 3px var(--error-subtle);
    }
  }
}
```

---

## Using Tokens in Figma

### Naming Layers

Name Figma layers with token references:

```
✅ Good layer names:
- "bg/default"
- "text/primary"
- "spacing-6"
- "radius-md"

❌ Bad layer names:
- "white background"
- "dark text"
- "24px spacing"
- "8px corners"
```

---

### Using Variables

Map Figma variables to design tokens:

1. **Create variable collections** matching token categories
2. **Name variables** using token names
3. **Assign values** from foundation tokens
4. **Create modes** for light/dark themes
5. **Apply variables** to layers instead of hard values

**Example Figma variables**:
```
Collection: Text Colors
├─ text/strong → #121212 (Light) / #FFFFFF (Dark)
├─ text/primary → #30302E (Light) / #F5F5F2 (Dark)
└─ text/secondary → #404040 (Light) / #C2C2BF (Dark)
```

---

### Using Styles

Create Figma styles based on tokens:

**Color Styles**:
- `color/text/primary` → `--text-primary`
- `color/bg/default` → `--bg-default`
- `color/primary/default` → `--primary-default`

**Text Styles**:
- `heading/h1` → `--font-4xl` + `--font-bold`
- `body/default` → `--font-base` + `--font-regular`
- `caption` → `--font-xs` + `--font-regular`

**Effect Styles**:
- `shadow/card` → `--shadow-md`
- `shadow/modal` → `--shadow-xl`

---

## Common Mistakes to Avoid

### ❌ Using Foundation Tokens for Colors

```scss
// Wrong
.text {
  color: var(--neutral-950);
}

// Right
.text {
  color: var(--text-primary);
}
```

**Why**: Semantic tokens adapt to themes; foundation tokens don't.

---

### ❌ Hardcoding Values

```scss
// Wrong
.card {
  padding: 24px;
  border-radius: 8px;
}

// Right
.card {
  padding: var(--spacing-6);
  border-radius: var(--radius-md);
}
```

**Why**: Tokens enable systematic changes across the system.

---

### ❌ Creating Custom Values

```scss
// Wrong
.component {
  padding: calc(var(--spacing-4) + 3px);  // 19px - off scale
}

// Right
.component {
  padding: var(--spacing-5);  // 20px - on scale
}
```

**Why**: Custom calculations break the design system rhythm.

---

### ❌ Mixing Hierarchy Levels

```scss
// Wrong - subtle background with strong text
.badge {
  background: var(--primary-subtle);
  color: var(--text-strong);
}

// Right - matching emphasis levels
.badge {
  background: var(--primary-subtle);
  color: var(--primary-default);
}
```

**Why**: Visual weight should match semantic importance.

---

### ❌ Ignoring Semantic Meaning

```scss
// Wrong - using error color for delete button
.delete-button {
  background: var(--error-default);
}

// Right - error is for feedback, not actions
.delete-button {
  background: var(--primary-default);
  /* Use error styling on confirmation dialog */
}
```

**Why**: Status colors are for feedback, not actions.

---

## Quick Reference

### Token Selection Cheatsheet

**For text**: Use `--text-*` tokens
**For backgrounds**: Use `--bg-*` tokens
**For borders**: Use `--border-*` tokens
**For buttons**: Use `--primary-*`, `--secondary-*`, or `--tertiary-*`
**For alerts**: Use `--success-*`, `--warning-*`, `--error-*`, or `--info-*`
**For spacing**: Use `--spacing-*` tokens
**For corners**: Use `--radius-*` tokens
**For shadows**: Use `--shadow-*` tokens
**For motion**: Use `--transition-*` tokens

---

## Next Steps

- **[Reading Guide](/?path=/docs/bioma-2-0-foundations-design-tokens-reading-guide)** - Understand token names
- **[Authoring Guide](/?path=/docs/bioma-2-0-foundations-design-tokens-authoring-guide)** - Create new tokens
- **[All Tokens](/?path=/docs/bioma-2-0-foundations-design-tokens-all-tokens)** - Complete token reference
